<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><!--

* AerWebCopy Engine [version 6.3.0]
* Copyright Aeroson Systems & Co.
* File mirrored from https://projecteuler.net/minimal=560
* At UTC time: 2022-02-01 15:40:03.202623

--><body><p>Coprime Nim is just like ordinary normal play Nim, but the players may only remove a number of stones from a pile  that is <b>coprime</b> with the current size of the pile. Two players remove stones in turn. The player who removes the last stone wins.</p>

<p>Let L(<var>n</var>,&#160;<var>k</var>) be the number of <b>losing</b> starting positions for the first player, assuming perfect play, when the game is played with <var>k</var> piles, each having between 1 and <var>n</var>&#160;-&#160;1 stones inclusively.</p>

<p>For example, L(5,&#160;2)&#160;=&#160;6 since the losing initial positions are (1,&#160;1), (2,&#160;2), (2,&#160;4), (3,&#160;3), (4,&#160;2) and (4,&#160;4).<br>
You are also given L(10,&#160;5)&#160;=&#160;9964, L(10,&#160;10)&#160;=&#160;472400303, L(10<sup>3</sup>,&#160;10<sup>3</sup>)&#160;mod&#160;1&#160;000&#160;000&#160;007&#160;=&#160;954021836.</p>

<p>Find L(10<sup>7</sup>,&#160;10<sup>7</sup>)&#160;mod&#160;1&#160;000&#160;000&#160;007</p>

</body></html>