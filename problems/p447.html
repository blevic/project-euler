<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><!--

* AerWebCopy Engine [version 6.3.0]
* Copyright Aeroson Systems & Co.
* File mirrored from https://projecteuler.net/minimal=447
* At UTC time: 2022-02-01 15:36:15.293783

--><body><p>
For every integer $n&gt;1$, the family of functions $f_{n,a,b}$ is defined 
by  <br>
$f_{n,a,b}(x)\equiv a x + b \mod n\,\,\, $ for $a,b,x$ integer and  $0&lt; a &lt;n, 0 \le b &lt; n,0 \le x &lt; n$. </p>
<p>
We will call $f_{n,a,b}$ a <i>retraction</i> if $\,\,\, f_{n,a,b}(f_{n,a,b}(x)) \equiv f_{n,a,b}(x) \mod n \,\,\,$ for every $0 \le x &lt; n$.<br>
Let $R(n)$ be the number of retractions for $n$.
</p>
<p>
$\displaystyle F(N)=\sum_{n=2}^N R(n)$. <br> 
$F(10^7)\equiv 638042271 \mod 1\,000\,000\,007$.<br></p>
<p>
Find $F(10^{14})$.<br>
Give your answer modulo $1\,000\,000\,007$.
</p>


</body></html>