<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><!--

* AerWebCopy Engine [version 6.3.0]
* Copyright Aeroson Systems & Co.
* File mirrored from https://projecteuler.net/minimal=746
* At UTC time: 2022-02-01 15:46:13.572077

--><body><p>$n$ families, each with four members, a father, a mother, a son and a daughter, were invited to a restaurant. They were all seated at a large circular table with $4n$ seats such that men and women alternate.</p>

<p>Let $M(n)$ be the number of ways the families can be seated such that none of the families were seated together. A family is considered to be seated together only when all the members of a family sit next to each other.</p>

<p>For example, $M(1)=0$, $M(2)=896$, $M(3)=890880$ and $M(10) \equiv 170717180 \pmod {1\,000\,000\,007}$</p>

<p>Let $S(n)=\displaystyle \sum_{k=2}^nM(k)$</p>

<p>For example, $S(10) \equiv 399291975 \pmod {1\,000\,000\,007}$</p>

<p>Find $S(2021)$. Give your answer modulo $1\,000\,000\,007$.</p>

</body></html>