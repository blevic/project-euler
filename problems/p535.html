<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><!--

* AerWebCopy Engine [version 6.3.0]
* Copyright Aeroson Systems & Co.
* File mirrored from https://projecteuler.net/minimal=535
* At UTC time: 2022-02-01 15:39:13.354587

--><body><p>Consider the infinite integer sequence S starting with:<br><var>S</var> = 1, 1, 2, 1, 3, 2, 4, 1, 5, 3, 6, 2, 7, 8, 4, 9, 1, 10, 11, 5, ...</p>

<p>Circle the first occurrence of each integer.<br><var>S</var> = &#9312;, 1, &#9313;, 1, &#9314;, 2, &#9315;, 1, &#9316;, 3, &#9317;, 2, &#9318;, &#9319;, 4, &#9320;, 1, &#9321;, &#9322;, 5, ...</p>

<p>The sequence is characterized by the following properties:</p>
<ul><li>The circled numbers are consecutive integers starting with 1.</li>
<li>Immediately preceding each non-circled numbers <var>a<sub>i</sub></var>, there are exactly &#8970;&#8730;<var>a<sub>i</sub></var>&#8971; adjacent circled numbers, where &#8970;&#8971; is the floor function.</li>
<li>If we remove all circled numbers, the remaining numbers form a sequence identical to <var>S</var>, so <var>S</var> is a <b>fractal sequence</b>.</li></ul><p>Let T(<var>n</var>) be the sum of the first <var>n</var> elements of the sequence.<br>
You are given T(1)&#160;=&#160;1, T(20)&#160;=&#160;86, T(10<sup>3</sup>)&#160;=&#160;364089 and T(10<sup>9</sup>)&#160;=&#160;498676527978348241.</p>

<p>Find T(10<sup>18</sup>). Give the last 9 digits of your answer.</p>
</body></html>